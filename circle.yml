machine:
  pre:
    - curl -sSL https://s3.amazonaws.com/circle-downloads/install-circleci-docker.sh | bash -s -- 1.10.0
  services:
    - docker

dependencies:
  override:
    - docker login -e $DOCKER_EMAIL -u $DOCKER_USERNAME -p $DOCKER_PASS
    - docker pull yshrsmz/android
    - echo $JKS | base64 -d > ./monotweety.jks
    - echo $SECRETS | base64 -d > ./secret.properties
    - echo $GOOGLE_SERVICE_JSON | base64 -d > ./app/google-services.json

test:
  override:
    - docker run -v .:/monotweety -t yshrsmz/android /bin/bash /monotweety/scripts.ci.sh